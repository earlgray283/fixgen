func Create{{.TableName}}(t *testing.T, db *spanner.Client, m *yo_gen.{{.TableName}}, opts ...func(*yo_gen.{{ .TableName }})) *yo_gen.{{.TableName}} {
  t.Helper()

  tbl := &yo_gen.{{.TableName}} { {{ range $i, $f := .Fields }}
      {{ if not $f.IsSpannerNullType }} {{ $f.Name }}: {{ $f.DefaultValue }}, {{ end }} {{ end }}
  }

  {{ range $i, $f := .Fields }} if {{ if $f.IsSpannerNullType }} !m.{{ $f.Name }}.IsNull() {{ else }} isModified(m.{{ $f.Name }}) {{ end }} {
      {{ if $f.AllowCommitTimestamp }} t.Fatal("spanner.CommitTimestamp should be used") {{ else }} tbl.{{ $f.Name }} = m.{{ $f.Name }} {{end}}
  }
  {{ end -}}
  for _, opt := range opts {
    opt(tbl)
  }

  _, err := db.ReadWriteTransaction(context.Background(), func(ctx context.Context, tx *spanner.ReadWriteTransaction) error {
    return tx.BufferWrite([]*spanner.Mutation{tbl.Insert(ctx)})
  })
  if err != nil {
    t.Fatal(err)
  }

  return tbl
}

